### Golang map 的存储策略
获得到 key 后，对 key 进行 hash 映射，映射到对应的桶数组中，进行存储。
### map 的解决冲突的策略
map 是结合了拉链法和开放寻址法的方法，来解决冲突
首先，map 中有 2^B 个桶数组，当两个 Key 冲突了，则先存入对应的下标中的桶链表中的（拉链法），逐步往后寻找空位（开放寻址法）。桶数组下标接的是一个桶链表，每一个桶可以存 8 个 k-v 对，当存满后，继续往后开辟一个新的桶接上。（如下图）
![[Pasted image 20250311155827.png]]
### map的扩容策略
map 的扩容策略是——增量扩容+等量扩容。
增量扩容：当桶内k-v 总数/桶数组长度 > 6.5，则增量扩容，数组长度翻倍（认为存储密度太大，信息过于密集）。但是这个时候并不是完整直接迁入（时间开销太大），而是采用渐进扩容的方式，当桶被实际操作到时，由使用者负责完成数据迁移，避免因为一次性的全量数据迁移引发性能抖动。
等量扩容：当桶内溢出桶数量大于等于 2^B 时( B 为桶数组长度的指数，B 最大取 15)，发生等量扩容，桶的长度保持为原值；（认为存储密度太低，很多桶内都有余量，只是链表太长）